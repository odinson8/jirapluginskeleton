<!--
Written by Veniture

TODO
Ä°ssue Link olsun
-->

$webResourceManager.requireResource("com.veniture.resourceManagement:resourceManagement-resources")

<!--
Created using JS Bin
http://jsbin.com

Copyright (c) 2019 by venITure

Released under the MIT license: http://jsbin.mit-license.org
-->
<html>

<head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- Latest Sortable -->
    <script src="https://raw.githack.com/SortableJS/Sortable/master/Sortable.js"></script>
    <meta charset="utf-8">
    <title>Priority Screen</title>

    <meta name="decorator" content="atl.general">
    <style id="css">
        body {
            margin: 10px;
        }

        #tableBody>tr {
            cursor: move;
            cursor: -webkit-grabbing;
        }
    </style>

    <script>
        AJS.$(document).ready(function () {
            // List with handle
            Sortable.create(tableBody, {
                handle: 'tr',
                animation: 150,
                onUpdate: function (evt) {
                    updatePriorities();
                }
            });

            AJS.tablessortable.setTableSortable(AJS.$("#auiTable"));

            function updatePriorities() {
                var i = 0;

                var len = AJS.$('#tableBody > tr').length;
                var tableBody = AJS.$('#tableBody > tr');
                var tableBodyLength = tableBody.length;
                tableBody.each(function () {
                    AJS.$(this).find(".age").text(i + 1);
                    i++;
                });
                console.log("Priorities are updated");
            }
        });
    </script>
</head>

<body>

<div id="tableDiv" class="list-group">
    <table class="aui" id="auiTable">
        <thead>
        <tr>
            <th class="aui-table-column-issue-key">Issue key</th>
            <th>Project</th>
            <th class="aui-table-column-unsortable">Description</th>
            <th>Priority</th>
        <tr>
        </thead>
        <tbody id="tableBody">
        <tr>
            <td>TEST-12</td>
            <td>Cannot sort tables</td>
            <td>Table sorting should be allowed</td>
            <td class="age">2</td>
        </tr>
        <tr>
            <td>WIN-87</td>
            <td>Issue Page doesn't load in IE</td>
            <td>When loading issue page on IE it doesn't show</td>
            <td class="age">7</td>
        </tr>
        <tr>
            <td>DRINK-7</td>
            <td>Vending Machine is empty</td>
            <td>Blocker</td>
            <td class="age">1</td>
        </tr>
        </tbody>
    </table>
</body>
</html>